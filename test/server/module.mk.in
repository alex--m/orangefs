DIR := test/server

TESTSRC += \
	$(DIR)/crdirent.c \
	$(DIR)/create.c \
	$(DIR)/getattr.c \
	$(DIR)/getconfig.c \
	$(DIR)/mkdir.c \
	$(DIR)/readdir.c \
	$(DIR)/setattr.c \
	$(DIR)/io.c \
	$(DIR)/showconfig.c

# special rule for io test program, which needs several other
# libraries at the moment
test/server/io: test/server/io.o
	$(LD) $< $(LDFLAGS) $(LIBS) -ldb -lrt -lpthread -o $@

# special rule for the config dumper, which pulls an object from the server
# this is rather gross, but it *does* avoid copying code around
SHOWCONFIG_OBJ := test/server/showconfig.o \
	src/common/misc/server-config.o \
	src/common/dotconf/dotconf.o \
	src/common/misc/mkspace.o
test/server/showconfig: $(SHOWCONFIG_OBJ)
	$(LD) $^ $(LDFLAGS) $(LIBS) -ldb -lrt -lpthread -o $@
