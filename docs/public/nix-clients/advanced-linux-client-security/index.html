<!DOCTYPE html>
<html>
  <head>
    <title>OrangeFS Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.42" />
<title>Linux Client Advanced Security Modes :: OrangeFS Documentation</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-blue.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/nix-clients/advanced-linux-client-security/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/">OrangeFS Documentation</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
</header>
<article>
  <aside>
    <ul class="menu">
    <li data-nav-id="/quickstart/" class="dd-item haschildren
        ">
      <div>
      <a href="/quickstart/">Quickstart Guides</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/quickstart/quickstart-package/" class="dd-item">
        <div>
          <a href="/quickstart/quickstart-package/">
            Quickstart Package Installation Guide
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/quickstart/quickstart-build/" class="dd-item">
        <div>
          <a href="/quickstart/quickstart-build/">
            Quickstart Source Build Guide
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/build-configure/" class="dd-item haschildren
        ">
      <div>
      <a href="/build-configure/">Build and Configure</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/build-configure/setup_security_build/" class="dd-item">
        <div>
          <a href="/build-configure/setup_security_build/">
            Build Security Setup
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/build_orangefs/" class="dd-item">
        <div>
          <a href="/build-configure/build_orangefs/">
            Build OrangeFS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/configuring_ldap_for_identity_mapping/" class="dd-item">
        <div>
          <a href="/build-configure/configuring_ldap_for_identity_mapping/">
            Configure LDAP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/create_orangefs_configuration_file/" class="dd-item">
        <div>
          <a href="/build-configure/create_orangefs_configuration_file/">
            OrangeFS Config File
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/results_of_build_and_configure/" class="dd-item">
        <div>
          <a href="/build-configure/results_of_build_and_configure/">
            Results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/add-servers/" class="dd-item haschildren
        ">
      <div>
      <a href="/add-servers/">Add Server(s)</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/add-servers/copy_ofs_install_directory_servers/" class="dd-item">
        <div>
          <a href="/add-servers/copy_ofs_install_directory_servers/">
            Copy OrangeFS Server Installation Directory
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/set_up_security_servers/" class="dd-item">
        <div>
          <a href="/add-servers/set_up_security_servers/">
            Set up Server Security
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/server-startup/" class="dd-item">
        <div>
          <a href="/add-servers/server-startup/">
            Server Startup
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/results_of_add_servers/" class="dd-item">
        <div>
          <a href="/add-servers/results_of_add_servers/">
            Add Server(s) Results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/nix-clients/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/nix-clients/">OrangeFS Clients</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/nix-clients/pvfs2tab-file/" class="dd-item">
        <div>
          <a href="/nix-clients/pvfs2tab-file/">
            pvfs2tab
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/linux-kernel-module/" class="dd-item">
        <div>
          <a href="/nix-clients/linux-kernel-module/">
            Linux Kernel Module
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/direct-interface/" class="dd-item">
        <div>
          <a href="/nix-clients/direct-interface/">
            Linux Direct Interface
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/romio-interface/" class="dd-item">
        <div>
          <a href="/nix-clients/romio-interface/">
            Linux ROMIO MPI Interface
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/advanced-linux-client-security/" class="dd-item active">
        <div>
          <a href="/nix-clients/advanced-linux-client-security/">
            Linux Client Advanced Security Modes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/fuse-client/" class="dd-item">
        <div>
          <a href="/nix-clients/fuse-client/">
            FUSE Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/hadoop_installation/" class="dd-item">
        <div>
          <a href="/nix-clients/hadoop_installation/">
            Hadoop Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-client/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-client/">Windows Client</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-client/preparing_for_installation_windows/" class="dd-item">
        <div>
          <a href="/windows-client/preparing_for_installation_windows/">
            Preparing for Windows Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/what_to_expect_windows/" class="dd-item">
        <div>
          <a href="/windows-client/what_to_expect_windows/">
            What to Expect
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/running_the_installation_program_windows/" class="dd-item">
        <div>
          <a href="/windows-client/running_the_installation_program_windows/">
            Installing the Software
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/manual_installation_windows/" class="dd-item">
        <div>
          <a href="/windows-client/manual_installation_windows/">
            Manual Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/uninstalling_the_client_windows/" class="dd-item">
        <div>
          <a href="/windows-client/uninstalling_the_client_windows/">
            Uninstalling the Windows client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/winclient_use/" class="dd-item">
        <div>
          <a href="/windows-client/winclient_use/">
            Using the Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/winclient_admin/" class="dd-item">
        <div>
          <a href="/windows-client/winclient_admin/">
            Client Administration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="/configuration/">OrangeFS Configuration</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/configuration/admin_ofs_configuration_file/" class="dd-item">
        <div>
          <a href="/configuration/admin_ofs_configuration_file/">
            OrangeFS Configuration File
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/configuration/orangefs_advanced_configuration/" class="dd-item">
        <div>
          <a href="/configuration/orangefs_advanced_configuration/">
            Multiple File Systems
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/configuration/multiple_server_processes/" class="dd-item">
        <div>
          <a href="/configuration/multiple_server_processes/">
            Multiple Server Processes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quickstart/" >
   Quickstart Guides</option>
    <option value="/build-configure/" >
   Build and Configure</option>
    <option value="/add-servers/" >
   Add Server(s)</option>
    <option value="/nix-clients/" >
   OrangeFS Clients</option> 
      <option value="/nix-clients/pvfs2tab-file/" >- pvfs2tab</option>
      <option value="/nix-clients/linux-kernel-module/" >- Linux Kernel Module</option>
      <option value="/nix-clients/direct-interface/" >- Linux Direct Interface</option>
      <option value="/nix-clients/romio-interface/" >- Linux ROMIO MPI Interface</option>
      <option value="/nix-clients/advanced-linux-client-security/"  selected>- Linux Client Advanced Security Modes</option>
      <option value="/nix-clients/fuse-client/" >- FUSE Client</option>
      <option value="/nix-clients/hadoop_installation/" >- Hadoop Client</option>
  
    <option value="/windows-client/" >
   Windows Client</option>
    <option value="/configuration/" >
   OrangeFS Configuration</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Linux Client Advanced Security Modes</h1>
    
    
    
    

<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>
<figure>
    
        <img src="../images/icon_security.png" alt="Security Icon" width="50" />
    
    
</figure>
</td>
<td>After you copy the OrangeFS installation directory, you must perform additional setup and configuration for the advanced key-based and certificate-based security modes.</td>
</tr>
</tbody>
</table>

<p>For key-based security, most of this work can be done once on the build system, then copied later to your servers and clients.</p>

<p>This topic includes sections for setting up two types of security:</p>

<ul>
<li><a href="Set_Up_Security_(Linux_Clients).htm#Key-Based_Security">Key-Based Security</a></li>
<li><a href="Set_Up_Security_(Linux_Clients).htm#Certificate-Based_Security">Certificate-Based Security</a>
<br /></li>
</ul>

<h2 id="key-based-security">Key-Based Security</h2>

<p>Each client has its own key pair, consisting of a private key and a
public key that are cryptographically related. The private key is kept
secret while the public key can be distributed. A file used by the
servers known as the keystore contains public keys for all servers and
clients in the OrangeFS system.  When a client sends a request to the
server, it submits a credential object which is signed by its private
key. The server verifies the signature using the known public key of the
client.</p>

<p><strong>Note     </strong>All OrangeFS clients and servers must be built for the same
security mode (key-based in this case) to interoperate.</p>

<h3 id="generating-client-private-keys">Generating Client Private Keys</h3>

<p>Like servers, all client systems must have a key pair. Because you need
to build the keystore file for the servers, you should create the client
private keys on a single server—typically the one you used to create the
server private keys. You can then distribute them to the clients.</p>

<p>The openssl command used is the same as for the server, although for
performance reasons the size of the key (in bits) is less:</p>

<p>openssl genrsa -out pvfs2-clientkey.pem 1024</p>

<p>The size of the client private key, 1024 bits, is usually half the size
of the server keys (default 2048).</p>

<p>This file is typically stored in the etc directory under the OrangeFS
installation directory, /opt/orangefs/etc by default.</p>

<p>Keys for multiple clients can be generated in a temporary directory and
distributed to the client systems in a similar fashion as the server
keys.</p>

<h3 id="configure-client-for-key-based-security">Configure Client for Key-Based Security</h3>

<p>On OrangeFS client systems, the private key should be readable only by
root:</p>

<p>chmod 600 /opt/orangefs/etc/pvfs2-clientkey.pem</p>

<p>The default private key location is pvfs2-clientkey.pem in the etc
directory under the OrangeFS installation directory, for example
/opt/orangefs/etc/pvfs2-clientkey.pem. You can override this location by
using the &ndash;keypath parameter when running pvfs2-client. Example:</p>

<p>/opt/orangefs/sbin/pvfs2-client &ndash;keypath \<br />
 /usr/local/orangefs/etc/pvfs2-clientkey.pem</p>

<h3 id="copy-files-to-client">Copy Files to Client</h3>

<p>The script pvfs2-dist-keys.sh distributes private keys and the keystore
to multiple systems using scp. The keys should have been generated with
the pvfs2-gen-keys.sh script as described in the <em><a href="_Automated_Key_and_Keystore_Generation_Scripts1.htm#Generating_Key_Pairs_and_a_Keystore">Administration
Guide</a>.</em></p>

<p><strong>Note     </strong>The script requires one argument: the installation
directory of OrangeFS which must be the same on all systems. This
directory must exist prior to executing the script.</p>

<p>An example using the default location:</p>

<p>./pvfs2-dist-keys.sh /opt/orangefs</p>

<p>The script examines the key filenames to determine the hostname of the
target server or client. For example, the server file
orangefs-serverkey-orangefs-server01.pem will cause the script to
execute this command, given /opt/orangefs as the installation directory:</p>

<p>scp
orangefs-serverkey-orangefs-server01.pem    orangefs-server01:/opt/orangefs/etc/orangefs-serverkey.pem</p>

<p>Generate a client private key as instructed in the <em><a href="Setting_Up_Key-Based_Security_Mode.htm#Generating_Client_Private_Keys">Administration
Guide</a></em>
and append its public key to the keystore. Distribute the private key to
the client system and the keystore to all servers.</p>

<p>To remove a client, edit the keystore file and remove the hostname
identifier (for example “C:client01”) and the public key that follows.
Distribute this updated keystore file to all servers.</p>

<p>Currently in key-based security when a client is added to (or removed
from) your OrangeFS installation, all servers must be stopped and
restarted. The keystore is read only at server startup, so you would
generally add clients during a maintenance period. Certificate-Based
Security can be used if a more dynamic system is needed.</p>

<h2 id="certificate-based-security">Certificate-Based Security</h2>

<p><strong>Note     </strong>All OrangeFS clients and servers must be built for the same
security mode (certificates, in this case) to interoperate.</p>

<p>Prior to configuring your client(s) for certificate-based security, you
must configure your servers and create a CA certificate. See <a href="Setting_Up_Certificate-Based_Security_Mode.htm#Building_OrangeFS_for_Certificate-Based_Security__Admin_Guide_">Building
OrangeFS for Certificate-Based
Security</a>
for steps to take before configuring clients.</p>

<p>Then, install OpenSSL client libraries to the client system if
necessary. (Consult your OS distribution documentation for more
information.)</p>

<h3 id="user-certificate-application">User Certificate Application</h3>

<p>A client application, pvfs2-get-user-cert, is installed to allow users
to request and receive a user certificate with no intervention from the
administrator.</p>

<p>You must configure the client system to connect to a running OrangeFS
server; the file pvfs2tab, located in /opt/orangefs/etc by default,
contains the necessary configuration information. (See <a href="pvfs2tab_File.htm">pvfs2tab
File</a> for more information on pvfs2tab.)</p>

<p>The requesting user must have an identity (user account) in the LDAP
directory before requesting a certificate. See <a href="http://www.omnibond.com/orangefs/docs/v_2_9/admin_Certificate-Based_Security.htm#Configuring_LDAP_for_Identity_Mapping">Configuring LDAP for
Identity
Mapping</a>
for more information.</p>

<p>The usage of pvfs2-get-user-cert is:</p>

<p>pvfs2-get-user-cert [<em>user name</em>]</p>

<p>If the optional user name is not supplied, the user name of the
currently-active user account will be used. The user will be prompted
for their LDAP directory password. Once this is entered correctly, the
user certificate and private key are stored
as ~/.pvfs2-cert.pem and ~/.pvfs2-cert-key.pem, respectively.</p>

<h3 id="obtaining-a-user-certificate-manually">Obtaining a User Certificate Manually</h3>

<p>If you do not want users to use the pvfs2-get-user-cert application,
they can create a certificate request, which an administrator can use to
generate a certificate.</p>

<h4 id="creating-a-user-certificate-request">Creating a User Certificate Request</h4>

<p>A certificate request is a file indicating what values should be in the
requested certificate. A user can generate the request and submit the
file to the administrator for signing by the CA certificate. In a
production environment, it is not secure for users to sign their own
certificates.</p>

<p>To generate a certificate request, execute this command:</p>

<p>openssl req -newkey rsa:1024 -config pvfs2-user.cnf -keyout
pvfs2-cert-key.pem -nodes -out pvfs2-cert-req.pem</p>

<p><strong>Note     </strong>pvfs2-user.cnf is in the examples/certs directory.</p>

<p>You can use different file names. The user will be prompted to enter
subject values, which should follow some organization-defined naming
scheme.</p>

<p><strong>Note     </strong>The common name of the certificate subject will be used for
UID/GID-mapping later, so take note of it.</p>

<p>The user can then submit (for example via email) the certificate request
(but not the private key) to the administrator for signing.</p>

<p>A script named pvfs2-cert-req.sh is in examples/certs for this step. It
takes a name as an optional parameter (default “pvfs2”):</p>

<p>./pvfs2-cert-req.sh pvfs2</p>

<h4 id="signing-a-user-certificate-request">Signing a User Certificate Request</h4>

<p>The administrator will sign the certificate request with the CA private
key. Execute this command:</p>

<p>openssl x509 -req -in pvfs2-cert-req.pem -CA orangefs-ca-cert.pem -CAkey
orangefs-ca-cert-key.pem -days 365 -out pvfs2-cert.pem</p>

<p>The file names should correspond with file names used in prior steps.
Return the resulting certificate file (pvfs2-cert.pem above) to the
user.</p>

<p>A script named pvfs2-sign-cert.sh is in examples/certs. It takes
the cert name and the CA name as optional parameters (defaults “pvfs2”
and “orangefs” respectively):</p>

<p>./pvfs2-cert-sign.sh pvfs2 orangefs</p>

<p>The files pvfs2-cert.pem and pvfs2-cert-key.pem can then be sent to the
user (for example via email).</p>

<h4 id="storing-the-user-certificate">Storing the User Certificate</h4>

<p>The user can now store the certificate and private key files. The
default file names used by OrangeFS are ~/.pvfs2-cert.pem for the
certificate file and ~/.pvfs2-cert-key.pem for the key file. Note the
“.” preceding both names, which marks them hidden. The private key and
certificate should have permissions revoked for other users:</p>

<p>mv pvfs2-cert.pem~/.pvfs2-cert.pem<br />
 mv pvfs2-cert-key.pem~/.pvfs2-cert-key.pem<br />
 chmod 600~/.pvfs2-cert*.pem</p>

<p>These locations can be overridden with
the PVFS2CERT_FILE and PVFS2KEY_FILE environment variables. These
variables are used when accessing OrangeFS through a client application
(sysint&ndash;for example pvfs2-ls) or library (usrint); they are not used if
OrangeFS is mounted through the kernel module.</p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/nix-clients/romio-interface/" title="Linux ROMIO MPI Interface"> <i class="fa fa-chevron-left"></i><label>Linux ROMIO MPI Interface</label></a>
    <a class="nav nav-next" href="/nix-clients/fuse-client/" title="FUSE Client" style="margin-right: 0px;"><label>FUSE Client</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  


	<div>


  
    <div id="image-table">
    <table>
        <tr>
              <td style="padding:1px">
              <a href="http://orangefs.com"> <img src="/OrangeFS_logo.gif" alt="OrangeFS" style="width:200px"></a>
            </td>
        </tr>
    </table>
</div>

  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>