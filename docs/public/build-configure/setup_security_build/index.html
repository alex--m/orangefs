<!DOCTYPE html>
<html>
  <head>
    <title>OrangeFS Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-10-06T16:42:54 EDT">
<title>Build Security Setup :: OrangeFS Documentation</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-gray.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="">



    
  </head>
  <body data-url="/build-configure/setup_security_build/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/">OrangeFS Documentation</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
</header>
<article>
  <aside>
    <ul class="menu">
    <li data-nav-id="/quickstart/" class="dd-item haschildren
        ">
      <div>
      <a href="/quickstart/">Quickstart Guides</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/quickstart/quickstart-package/" class="dd-item">
        <div>
          <a href="/quickstart/quickstart-package/">
            Quickstart Package Installation Guide
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/quickstart/quickstart-build/" class="dd-item">
        <div>
          <a href="/quickstart/quickstart-build/">
            Quickstart Source Build Guide
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/build-configure/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/build-configure/">Build and Configure</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/build-configure/setup_security_build/" class="dd-item active">
        <div>
          <a href="/build-configure/setup_security_build/">
            Build Security Setup
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/build_orangefs/" class="dd-item">
        <div>
          <a href="/build-configure/build_orangefs/">
            Build OrangeFS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/configuring_ldap_for_identity_mapping/" class="dd-item">
        <div>
          <a href="/build-configure/configuring_ldap_for_identity_mapping/">
            Configure LDAP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/create_orangefs_configuration_file/" class="dd-item">
        <div>
          <a href="/build-configure/create_orangefs_configuration_file/">
            OrangeFS Config File
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/build-configure/results_of_build_and_configure/" class="dd-item">
        <div>
          <a href="/build-configure/results_of_build_and_configure/">
            Results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/add-servers/" class="dd-item haschildren
        ">
      <div>
      <a href="/add-servers/">Add Server(s)</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/add-servers/copy_ofs_install_directory_servers/" class="dd-item">
        <div>
          <a href="/add-servers/copy_ofs_install_directory_servers/">
            Copy OrangeFS Server Installation Directory
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/set_up_security_servers/" class="dd-item">
        <div>
          <a href="/add-servers/set_up_security_servers/">
            Set up Server Security
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/server-startup/" class="dd-item">
        <div>
          <a href="/add-servers/server-startup/">
            Server Startup
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/add-servers/results_of_add_servers/" class="dd-item">
        <div>
          <a href="/add-servers/results_of_add_servers/">
            Add Server(s) Results
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/nix-clients/" class="dd-item haschildren
        ">
      <div>
      <a href="/nix-clients/">OrangeFS Clients</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/nix-clients/pvfs2tab-file/" class="dd-item">
        <div>
          <a href="/nix-clients/pvfs2tab-file/">
            pvfs2tab
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/linux-kernel-module/" class="dd-item">
        <div>
          <a href="/nix-clients/linux-kernel-module/">
            Linux Kernel Module
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/direct-interface/" class="dd-item">
        <div>
          <a href="/nix-clients/direct-interface/">
            Linux Direct Interface
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/romio-interface/" class="dd-item">
        <div>
          <a href="/nix-clients/romio-interface/">
            Linux ROMIO MPI Interface
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/advanced-linux-client-security/" class="dd-item">
        <div>
          <a href="/nix-clients/advanced-linux-client-security/">
            Linux Client Advanced Security Modes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/fuse-client/" class="dd-item">
        <div>
          <a href="/nix-clients/fuse-client/">
            FUSE Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/nix-clients/hadoop_installation/" class="dd-item">
        <div>
          <a href="/nix-clients/hadoop_installation/">
            Hadoop Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/windows-client/" class="dd-item haschildren
        ">
      <div>
      <a href="/windows-client/">Windows Client</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/windows-client/preparing_for_installation_windows/" class="dd-item">
        <div>
          <a href="/windows-client/preparing_for_installation_windows/">
            Preparing for Windows Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/what_to_expect_windows/" class="dd-item">
        <div>
          <a href="/windows-client/what_to_expect_windows/">
            What to Expect
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/running_the_installation_program_windows/" class="dd-item">
        <div>
          <a href="/windows-client/running_the_installation_program_windows/">
            Installing the Software
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/manual_installation_windows/" class="dd-item">
        <div>
          <a href="/windows-client/manual_installation_windows/">
            Manual Installation
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/uninstalling_the_client_windows/" class="dd-item">
        <div>
          <a href="/windows-client/uninstalling_the_client_windows/">
            Uninstalling the Windows client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/winclient_use/" class="dd-item">
        <div>
          <a href="/windows-client/winclient_use/">
            Using the Client
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/windows-client/winclient_admin/" class="dd-item">
        <div>
          <a href="/windows-client/winclient_admin/">
            Client Administration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/configuration/" class="dd-item haschildren
        ">
      <div>
      <a href="/configuration/">OrangeFS Configuration</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/configuration/admin_ofs_configuration_file/" class="dd-item">
        <div>
          <a href="/configuration/admin_ofs_configuration_file/">
            OrangeFS Configuration File
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/configuration/orangefs_advanced_configuration/" class="dd-item">
        <div>
          <a href="/configuration/orangefs_advanced_configuration/">
            Multiple File Systems
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/configuration/multiple_server_processes/" class="dd-item">
        <div>
          <a href="/configuration/multiple_server_processes/">
            Multiple Server Processes
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/quickstart/" >
   Quickstart Guides</option>
    <option value="/build-configure/" >
   Build and Configure</option> 
      <option value="/build-configure/setup_security_build/"  selected>- Build Security Setup</option>
      <option value="/build-configure/build_orangefs/" >- Build OrangeFS</option>
      <option value="/build-configure/configuring_ldap_for_identity_mapping/" >- Configure LDAP</option>
      <option value="/build-configure/create_orangefs_configuration_file/" >- OrangeFS Config File</option>
      <option value="/build-configure/results_of_build_and_configure/" >- Results</option>
  
    <option value="/add-servers/" >
   Add Server(s)</option>
    <option value="/nix-clients/" >
   OrangeFS Clients</option>
    <option value="/windows-client/" >
   Windows Client</option>
    <option value="/configuration/" >
   OrangeFS Configuration</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>Build Security Setup</h1>
    
    
    
    

<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>
<figure>
    
        <img src="../images/icon_security.png" alt="Security Icon" width="50" />
    
    
</figure>
</td>
<td>After you build the OrangeFS installation directory, you must continue setup and configuration if you select either the key-based or certificate-based mode of security. Much of this work can be done once on the build system, then copied to your servers and clients. In future versions of OrangeFS, security will be simplified.</td>
</tr>
</tbody>
</table>

<hr />

<p>In the <a href="Build_OrangeFS.htm#Procedure">Procedure</a> section of the previous
topic, you specified a security mode when running ./configure (see <a href="Build_OrangeFS.htm#Build_a_Makefile_for_OrangeFS">step
3</a> in Build OrangeFS).</p>

<p>Depending on the mode you chose (default, key-based or
certificate-based), refer to the appropriate sections in this topic for
additional security setup for the Build system:</p>

<ul>
<li><a href="#Default_Mode">Default_Mode</a></li>
<li><a href="#Key-Based_Mode">Key-Based_Mode</a></li>
<li><a href="#Certificate-Based_Mode">Certificate-Based_Mode</a></li>
</ul>

<h3 id="default-mode">Default Mode</h3>

<p>If security is not a priority, you might have selected the default mode
for optimal performance and faster installation. This mode does not
require any additional setup, so you can go to the next topic, <a href="Create_OrangeFS_Configuration_File.htm">Create
OrangeFS Configuration File</a>.</p>

<h3 id="key-based-mode">Key-Based Mode</h3>

<p>If you selected the key-based mode, you must create your security keys
and a keystore file in a temporary directory on the Build system. You
must then copy the keystore file to the OrangeFS installation directory.</p>

<p><strong>Notes   </strong>To complete this procedure, you must know the host names of
your OrangeFS servers and clients. <br />
 <br />
 This procedure assumes the use of an automated script provided with
your OrangeFS files. To learn how to create your security keys and
keystore manually, see the <a href="Administration_Guide.htm">Administration
Guide</a>.</p>

<h4 id="procedure">Procedure</h4>

<p>The following steps set up the Build system for key-based security. They
assume the OrangeFS source is in /tmp/src/orangefs-version.</p>

<ol>
<li>Create a temporary directory on the Build system, located outside
the /tmp/src/orangefs-<em>version</em> source directory:</li>
</ol>

<p>cd /opt<br />
 mkdir ofs_keys</p>

<p><strong>Note     </strong>Later, after you have distributed key pairs to your
OrangeFS servers and clients, you should either delete or limit access
to this directory. If you keep this directory for future changes, secure
it appropriately using best practices.</p>

<p> </p>

<ol>
<li>Change Directory (cd) to the new directory and copy two script files
from /tmp/src/orangefs-<em>version</em>/examples/keys:</li>
</ol>

<p>cd ofs_keys<br />
 cp /tmp/src/orangefs-<em>version</em>/examples/keys/*.sh .</p>

<p><strong>Note     </strong>You will use only one of these scripts now. You will use
the second one when you add OrangeFS servers later.</p>

<p> </p>

<ol>
<li>With the script named pvfs2-gen-keys.sh, use the following command
line format to generate private keys for servers and clients, as
well as the keystore:</li>
</ol>

<p>./pvfs2-gen-keys.sh [-a] [-s <em>servers</em>] [-c <em>clients</em>]</p>

<p>where&hellip;</p>

<p><em>servers</em> = server hostname(s), each separated by a space</p>

<p><em>Example:</em>  orangefs01 orangefs02 orangefs03</p>

<p> </p>

<p><em>clients</em> = client hostname(s), each separated by a space</p>

<p><em>Example:</em>  orangefs01 client01 client02</p>

<p><strong>Note     </strong>As this example suggests, an OrangeFS server can also be a
client.</p>

<p> </p>

<p>Example of full command:</p>

<p>./pvfs2-gen-keys.sh -s orangefs01 orangefs02 -c orangefs01 orangefs02</p>

<p> </p>

<p>The executed script will generate:</p>

<p>The keystore, named orangefs-keystore by default, is a text file that
contains the public keys for each server and client.</p>

<hr />

<p>Key File Type   File Name Format                    Example
  Server          orangefs-serverkey-<em>hostname</em>.pem   orangefs-serverkey-orangefs01.pem
  Client          pvfs2-clientkey-<em>hostname</em>.pem      pvfs2-clientkey-client01.pem</p>

<hr />

<p><strong>Note     </strong>The -a option shown in the command line format does not
apply during initial installation. Include this option only if you want
the public keys to be appended to an existing keystore (named keystore
by default).</p>

<p> </p>

<ol>
<li>Copy the keystore to the etc directory in your OrangeFS installation
directory:</li>
</ol>

<p>cp keystore /opt/orangefs/etc</p>

<p><strong>Note     </strong>This is the default location for the keystore on all
OrangeFS servers. If you specify a different location in the above copy
command, you must reflect that change later when you create the OrangeFS
configuration file.</p>

<p> </p>

<h4 id="generating-keys-for-many-systems">Generating Keys for Many Systems</h4>

<p>The command line format used in step 3 above can be modified for large
numbers of servers and clients, using shell expansion. For example, the
following command generates server keys for orangefs-server01 to
orangefs-server04 and client keys for orangefs-client01 to
orangefs-client40:</p>

<p>./pvfs2-gen-keys.sh -s orangefs-server0{1..4} -c orangefs-client0{1..9}
orangefs-client{10..40}</p>

<p>See your shell documentation for more information.</p>

<h2 id="certificate-based-mode">Certificate-Based Mode</h2>

<p>If you selected the certificate-based mode of security, you must add a
CA certificate to the OrangeFS directory on the Build system.</p>

<p>If you already have one you want to use, simply copy the certificate
file, along with its private key file, to /opt/orangefs/etc. Each of the
files should be in PEM format (see OpenSSL documentation).</p>

<p>If you need to create a CA certificate, the OrangeFS installation files
include some tools to simplify the process. You must have a working
knowledge of OpenSSL to tailor your certificate settings beyond the
basic procedure that follows.</p>

<h4 id="procedure-1">Procedure</h4>

<p>OpenSSL references a configuration file when it creates certificates,
including CA certificates.</p>

<p><strong>Note     </strong>This file is specifically tied to OpenSSL; it is different
from the OrangeFS configuration file.</p>

<p> </p>

<p>The default location for this file on the Build system is
/etc/ssl/openssl.cnf, but the following procedure uses an alternative
configuration file named orangefs.cnf. That file is located in
/opt/orangefs/examples/certs, and it includes basic &ldquo;quick start&rdquo;
settings that you can modify as needed.</p>

<p><strong>Note     </strong>For complete information on the OpenSSL configuration file
format, see the config(5ssl) Linux man page.</p>

<p> </p>

<p>To create a CA certificate (using the example configuration file):</p>

<ol>
<li>Change Directory (cd) to the directory where the example
configuration file is located:</li>
</ol>

<p>cd /tmp/src/orangefs-<em>version</em>/examples/certs</p>

<p> </p>

<ol>
<li>If necessary, customize the settings in the configuration file
(orangefs.cnf) to reflect the security settings and policies of your
organization.</li>
<li>Enter the following command:</li>
</ol>

<p>openssl req -config orangefs.cnf -new -x509 -outform PEM -out
orangefs-ca-cert.pem -keyout orangefs-ca-cert-key.pem -nodes -days 1825</p>

<p><strong>Notes   </strong>You can use different file names. You can also select a
different expiration; the above example expires in 5 years (1825 days)<br />
 <br />
 The documentation for this command is in the req(1) Linux man page.</p>

<p>You are prompted for configuration values after entering this command.</p>

<p> </p>

<ol>
<li>Enter the elements of the CA certificate subject.</li>
</ol>

<p>The configuration file will prompt you for country, state, locality,
organization, organizational unit and common name. You and your security
administrator might want to discuss the values any existing certificates
use and follow a similar format.</p>

<p>When you submit the entries, the CA certificate and private key you
specified (orangefs-ca-cert.pem and orangefs-ca-cert-key.pm in the
example above) will be generated in the current directory.</p>

<ol>
<li>Move the CA certificate and private key files to the etc
subdirectory in your OrangeFS installation directory:</li>
</ol>

<p>mv *.pem /opt/orangefs/etc</p>

<p> </p>

<h4 id="using-the-script-file">Using the Script File</h4>

<p>The examples/certs directory in your OrangeFS source directory also
includes a script (pvfs2-cert-ca.sh) to streamline the above procedure.
Its command line format includes a single optional parameter for any
characters you want to add to the certificate file names.</p>

<p>For example, to achieve the same results as in the above procedure, you
would enter:</p>

<p>./pvfs2-cert-ca.sh orangefs</p>

<p> </p>

<h4 id="restricting-access">Restricting Access</h4>

<p>Be sure to use chmod to restrict access to the CA key.</p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>


    
    
        <div class="chevrons">
    <div id="navigation">
</div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    

    
    <div class="github-link">
      <a href="https://github.com/waltligon/orangefs/tree/master/docsbuild-configure/Setup_Security_%28Build%29.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    <div id="image-table">
    <table>
        <tr>
              <td style="padding:1px">
              <a href="http://orangefs.com"> <img src="/OrangeFS_logo.gif" alt="OrangeFS" style="width:200px"></a>
            </td>
        </tr>
    </table>
</div>

  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>


<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>