PVFS Logging
============

This document describes log files produced by PVFS and how to control
what messages are included in them.

PVFS Log Format
---------------

The log messages from all PVFS components except for the kernel module
are in the following format: 

    [<type> <timestamp>] LOG MESSAGE

The type will be one of 4 different letters depending on what type of
log message it is:

    D - DEBUG 
    E - ERROR 
    A - ACCESS LOGGING
    P - PERFORMANCE COUNTER 

The timestamp defaults to showing the date, hour, and minute that the
log message was generated.  The timestamp format can be modified to one
of the following styles by using the --logstamp argument to pvfs2-client
or the LogStamp field in the pvfs2-server config file:

    datetime: (default, as described above)
    usec: shows time with microsecond granularity (but no date)
    none: no time stamp
    thread: includes thread ID with each message

PVFS Log Locations
------------------

The pvfs2-server daemon writes log messages to /tmp/pvfs2-server.log by
default.  A different output file can be specified using the LogFile
parameter in the configuration file.  The logs can also be sent to syslog
instead by adding "LogType syslog" to the configuration file.

The pvfs2-client daemon writes log messages to /tmp/pvfs2-client.log by
default.  This can be overridden using the --logfile or --logtype command
line arguments to pvfs2-client.

The PVFS kernel module (pvfs2.ko) generates log messages to dmesg and/or
/var/log/messages and/or /var/log/kern depending on your Linux distribution.

The PVFS client library (libpvfs2) and command line utilities generate log
messages to stderr if enabled.

Logging Levels
--------------

All PVFS components log critical error messages automatically.  However, 
you can also turn on additional logging for debugging purposes.  This is
controlled by specifying which logging "masks" should be enabled.

You can see a list of available pvfs2-server, client library, and
pvfs2-client logging levels by running the pvfs2-set-debugmask utility
with no arguments.

You can see a list of available kernel module logging masks by running "cat
/proc/sys/pvfs2/debug-help".

The "verbose" mask is commonly used to turn on most of the logging
levels that are useful for debugging problems.

Changing the log mask for pvfs2-server
--------------------------------------

Use the EventLogging field in the configuration file to specify
a comma separated list of masks to enable.  You can also use the
pvfs2-set-debugmask command line utility to change the mask dynamically
without restarting the server.

Changing the log mask for libpvfs and command line utilities
------------------------------------------------------------

Set the PVFS2_DEBUGMASK environment variable to a comma separated list of
masks prior to launching the application.

Changing the log mask for the kernel module and pvfs2-client
------------------------------------------------------------

